(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";var alterations=require("./alterations");var transpose=require("music.kit/note/transpose");module.exports=function(k){var a=alterations(k);if(a===null)return null;var notes=[];var tonic=a>0?"B":"F";var interval=a>0?[1,0]:[-1,0];var l=Math.abs(a);for(var i=0;i<l;i++){tonic=transpose(tonic,interval);notes.push(tonic)}return notes}},{"./alterations":2,"music.kit/note/transpose":29}],2:[function(require,module,exports){"use strict";var relative=require("./relative");var distance=require("music.kit/note/distance");var itc=require("music.kit/notation/itc");module.exports=function(key){var k=relative("major",key);return k?itc(distance("C",k.split(" ")[0]))[0]:null}},{"./relative":8,"music.kit/notation/itc":23,"music.kit/note/distance":27}],3:[function(require,module,exports){"use strict";var scale=require("./scale");var chord=require("music.kit/scale/chord");var modes=require("music.kit/scale/modes");module.exports=function(k){return modes(scale(k)).map(function(s){return chord(s)})}},{"./scale":9,"music.kit/scale/chord":35,"music.kit/scale/modes":36}],4:[function(require,module,exports){"use strict";var key=require("./key");key.alterations=require("./alterations");key.altNotes=require("./altNotes");key.chords=require("./chords");key.parse=require("./parse");key.progression=require("./progression");key.relative=require("./relative");key.scale=require("./scale");key.signature=require("./signature");module.exports=key},{"./altNotes":1,"./alterations":2,"./chords":3,"./key":5,"./parse":6,"./progression":7,"./relative":8,"./scale":9,"./signature":10}],5:[function(require,module,exports){"use strict";var parse=require("./parse");var transpose=require("music.kit/note/transpose");var REGEX=/^#{1,7}|b{1,7}$/;module.exports=function(str){if(/^-?\d$/.exec(str)){return major(+str)}else if(REGEX.exec(str)){var dir=str[0]==="b"?-1:1;return major(str.length*dir)}else{var p=parse(str);return p?p.tonic+" "+p.mode:null}};function major(n){return transpose("C",[n,0])+" major"}},{"./parse":6,"music.kit/note/transpose":29}],6:[function(require,module,exports){"use strict";var note=require("music.kit/note/note");var KEYS={major:1,minor:6,ionian:1,dorian:2,phrygian:3,lydian:4,mixolydian:5,aeolian:6,locrian:7};module.exports=function(name){var m,s,t;if(!name)return null;s=name.trim().split(/\s+/);t=note(s[0]);if(s.length===1){m=s[0].toLowerCase();if(KEYS[m])return k(null,m);else if(t)return k(t,"major");else return null}m=s[1].toLowerCase();if(t&&KEYS[m])return k(t,m);return null};function k(t,m){return{tonic:t||false,mode:m,dist:KEYS[m]}}},{"music.kit/note/note":28}],7:[function(require,module,exports){"use strict";var split=require("music.kit/gamut/split");var rtc=require("music.kit/notation/rtc");var itc=require("music.kit/notation/itc");var parse=require("./parse");var chords=require("./chords");var scale=require("./scale");module.exports=function(numerals,key){var k=parse(key);if(!k||!k.tonic)return null;var s=scale(k.mode).map(itc);var c=chords(key);var degrees=split(numerals).map(rtc);return degrees.map(function(d){var i=indexOf(d[0],s);return i<0?null:c[i]})};function indexOf(v,s){for(var i=0;i<7;i++){if(s[i][0]===v)return i}return-1}},{"./chords":3,"./parse":6,"./scale":9,"music.kit/gamut/split":18,"music.kit/notation/itc":23,"music.kit/notation/rtc":26}],8:[function(require,module,exports){"use strict";var parse=require("./parse");var transpose=require("music.kit/note/transpose");module.exports=function(rel,key){var k=parse(key);var r=parse(rel);if(!k||!k.tonic||!r)return null;var major=k.mode==="major"?k.tonic:transpose(k.tonic,"-"+k.dist);return r.mode==="major"?major+" major":transpose(major,""+r.dist)+" "+rel}},{"./parse":6,"music.kit/note/transpose":29}],9:[function(require,module,exports){"use strict";var set=require("music.kit/set/fromBinary");var key=require("./parse");var SCALES=[2773,2902,3418,2741,2774,2906,3434];module.exports=function(name){var k=key(name);if(!k)return[];return set(SCALES[k.dist-1],k.tonic)}},{"./parse":6,"music.kit/set/fromBinary":38}],10:[function(require,module,exports){"use strict";var alterations=require("./alterations");module.exports=function(key){var n=alterations(key);return n!==null?new Array(Math.abs(n)+1).join(n<0?"b":"#"):null}},{"./alterations":2}],11:[function(require,module,exports){"use strict";module.exports=function(fn){return function(a,b){if(arguments.length===1)return function(c){return fn(a,c)};return fn(a,b)}}},{}],12:[function(require,module,exports){"use strict";var harmonics=require("../gamut/harmonics");module.exports=function(chord){var g=harmonics(chord);var steps=g.map(function(i){return i.charAt(0)});if(steps[0]!=="1"||steps[1]!=="3"||steps[2]!=="5")return null;if(g[1]==="3M"){if(g[2]==="5A")return"aug";else return g[3]==="7m"?"7":"M"}else if(g[1]==="3m")return g[2]==="5P"?"m":"dim";return null}},{"../gamut/harmonics":13}],13:[function(require,module,exports){var operation=require("./operation");var distance=require("../note/distance");module.exports=operation(function(gamut){var tonic=gamut[0];return gamut.map(distance(tonic))})},{"../note/distance":27,"./operation":14}],14:[function(require,module,exports){var split=require("./split");var parse=require("../pitch/toCoord");var fromCoord=require("../pitch/fromCoord");module.exports=function op(fn,source){if(arguments.length>1)return op(fn)(source);return function(source){var g=split(source);if(Array.isArray(g[0]))return fn(g);var v=fn(g.map(parse));return Array.isArray(v)?v.map(fromCoord):v}}},{"../pitch/fromCoord":30,"../pitch/toCoord":34,"./split":18}],15:[function(require,module,exports){"use strict";var split=require("./split");module.exports=function(count,source){var g=split(source);var len=g.length;var n=(count%len+len)%len;return g.slice(n,len).concat(g.slice(0,n))}},{"./split":18}],16:[function(require,module,exports){"use strict";var curry=require("../_curry");var split=require("./split");module.exports=curry(function(nums,gamut){var g=split(gamut);return split(nums).map(function(n){return g[n-1]})})},{"../_curry":11,"./split":18}],17:[function(require,module,exports){"use strict";var height=require("../pitch/height");var operation=require("./operation");module.exports=operation(function(gamut){return gamut.sort(function(a,b){return height(a)-height(b)})})},{"../pitch/height":31,"./operation":14}],18:[function(require,module,exports){var SEP=/\s*\|\s*|\s*,\s*|\s+/;module.exports=function(source){if(Array.isArray(source))return source;else if(typeof source==="string")return source.trim().split(SEP);else if(source===null||typeof source==="undefined")return[];else return[source]}},{}],19:[function(require,module,exports){"use strict";module.exports=function(fn){var cache={};return function(str){if(typeof str!=="string")return null;return str in cache?cache[str]:cache[str]=fn(str)}}},{}],20:[function(require,module,exports){"use strict";var props=require("./ctp");var cache={};module.exports=function(arr){if(!Array.isArray(arr)||arr.length!==2)return null;var str="|"+arr[0]+"|"+arr[1];return str in cache?cache[str]:cache[str]=build(arr)};var ALTER={P:["dddd","ddd","dd","d","P","A","AA","AAA","AAAA"],M:["ddd","dd","d","m","M","A","AA","AAA","AAAA"]};var TYPES="PMMPPMM";function build(coord){var p=props(coord);var t=TYPES[p[0]];var dir,num,alt;if(p[2]<0){dir=-1;num=8-p[0]-7*(p[2]+1);alt=t==="P"?-p[1]:-(p[1]+1)}else{dir=1;num=p[0]+1+7*p[2];alt=p[1]}var q=ALTER[t][4+alt];return dir*num+q}},{"./ctp":22}],21:[function(require,module,exports){"use strict";var props=require("./ctp");var cache={};module.exports=function(arr){if(!Array.isArray(arr)||arr.length<1||arr.length===2)return null;var str="|"+arr[0]+"|"+arr[1]+"|"+arr[2];return str in cache?cache[str]:cache[str]=build(arr)};function accidentals(num){if(num<0)return Array(-num+1).join("b");else if(num>0)return Array(num+1).join("#");else return""}var LETTER=["C","D","E","F","G","A","B"];function build(coord){var p=props(coord);return LETTER[p[0]]+accidentals(p[1])+(p[2]!==null?p[2]:"")+(p[3]!==null?p[3]:"")}},{"./ctp":22}],22:[function(require,module,exports){"use strict";var BASES=[[3,1],[0,0],[4,0],[1,-1],[5,-1],[2,-2],[6,-2],[3,-3]];module.exports=function(arr){if(!Array.isArray(arr))return null;var index=(arr[0]+1)%7;if(index<0)index=7+index;var base=BASES[index];var alter=Math.floor((arr[0]+1)/7);var oct=arr.length===1?null:arr[1]-base[1]+alter*4;var dur=arr[2]?"/"+arr[2]:null;return[base[0],alter,oct,dur]}},{}],23:[function(require,module,exports){"use strict";var memo=require("./_memo");var ptc=require("./ptc");var INTERVAL=/^([-+]?)(\d+)(d{1,4}|m|M|P|A{1,4}|b{1,4}|#{1,4}|)$/;var TYPES="PMMPPMM";var QALT={P:{dddd:-4,ddd:-3,dd:-2,d:-1,P:0,A:1,AA:2,AAA:3,AAAA:4},M:{ddd:-4,dd:-3,d:-2,m:-1,M:0,A:1,AA:2,AAA:3,AAAA:4}};module.exports=memo(function parse(str){var m=INTERVAL.exec(str);if(!m)return null;var dir=m[1]==="-"?-1:1;var num=+m[2]-1;var simple=num%7;var alt;if(m[3]==="")alt=0;else if(m[3][0]==="#")alt=m[3].length;else if(m[3][0]==="b")alt=-m[3].length;else{alt=QALT[TYPES[simple]][m[3]];if(typeof alt==="undefined")return null}var oct=Math.floor(num/7);return ptc([simple,alt,oct,dir])})},{"./_memo":19,"./ptc":25}],24:[function(require,module,exports){"use strict";var memo=require("./_memo");var REGEX=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)(?:\/(\d+))?$/;var BASES={C:[0,0],D:[2,-1],E:[4,-2],F:[-1,1],G:[1,0],A:[3,-1],B:[5,-2]};module.exports=memo(function(str){var m=REGEX.exec(str);if(!m)return null;var base=BASES[m[1].toUpperCase()];var alt=m[2].replace(/x/g,"##").length;if(m[2][0]==="b")alt*=-1;var fifths=base[0]+7*alt;if(!m[3])return[fifths];var oct=+m[3]+base[1]-4*alt;return[fifths,oct,m[4]?+m[4]:null]})},{"./_memo":19}],25:[function(require,module,exports){var BASES=[[0,0],[2,-1],[4,-2],[-1,1],[1,0],[3,-1],[5,-2]];module.exports=function(c){var base=BASES[c[0]];if(c.length===2)return[base[0]+7*c[1]];return[c[3]*(base[0]+7*c[1]),c[3]*(c[2]+base[1]-4*c[1])]}},{}],26:[function(require,module,exports){"use strict";var ptc=require("./ptc");var REGEX=/^(b|bb|#|##|)(i|ii|iii|iv|v|vi|vii)$/;var NUM={i:0,ii:1,iii:2,iv:3,v:4,vi:5,vii:6};module.exports=function(str){var m=REGEX.exec(str.toLowerCase());var num=NUM[m[2]];if(typeof num==="undefined")return null;var alt=m[1].length;if(m[1][0]==="b")alt=-alt;return ptc([num,alt])}},{"./ptc":25}],27:[function(require,module,exports){var curry=require("../_curry");var operation=require("../pitch/operation");module.exports=curry(operation(function(a,b){if(!Array.isArray(a)||!Array.isArray(b))return null;if(a.length===1||b.length===1){var base=b[0]-a[0];return[base,-Math.floor(base*7/12)]}return[b[0]-a[0],b[1]-a[1]]}))},{"../_curry":11,"../pitch/operation":32}],28:[function(require,module,exports){"use strict";var parse=require("../notation/ntc");var str=require("../notation/ctn");module.exports=function(n){return str(parse(n))}},{"../notation/ctn":21,"../notation/ntc":24}],29:[function(require,module,exports){var operation=require("../pitch/operation");var curry=require("../_curry");module.exports=curry(operation(function(i,n){if(i===false)return n;else if(!Array.isArray(i)||!Array.isArray(n))return null;else if(i.length===1||n.length===1)return[n[0]+i[0]];var d=i.length===2&&n.length===2?null:n[2]||i[2];return[n[0]+i[0],n[1]+i[1],d]}))},{"../_curry":11,"../pitch/operation":32}],30:[function(require,module,exports){var ctn=require("../notation/ctn");var cti=require("../notation/cti");module.exports=function(n){return ctn(n)||cti(n)}},{"../notation/cti":20,"../notation/ctn":21}],31:[function(require,module,exports){"use strict";var operation=require("./operation");module.exports=operation(function(p){if(!Array.isArray(p))return-Infinity;var f=p[0]*7;var o=p[1]||p[1]===0?p[1]:-Math.floor(f/12)-10;return f+o*12})},{"./operation":32}],32:[function(require,module,exports){var toCoord=require("./toCoord");var fromCoord=require("./fromCoord");module.exports=function(fn){return function(a,b){var ac=toCoord(a);var bc=toCoord(b);if(!ac&&!bc)return fn(a,b);var v=fn(ac||a,bc||b);return fromCoord(v)||v}}},{"./fromCoord":30,"./toCoord":34}],33:[function(require,module,exports){var operation=require("./operation");module.exports=operation(function(p){if(!Array.isArray(p))return null;return p.length===2?[p[0],-Math.floor(p[0]*7/12)]:[p[0]]})},{"./operation":32}],34:[function(require,module,exports){var ntc=require("../notation/ntc");var itc=require("../notation/itc");module.exports=function(n){return ntc(n)||itc(n)}},{"../notation/itc":23,"../notation/ntc":24}],35:[function(require,module,exports){"use strict";var scale=require("./scale");var type=require("../chord/type");var select=require("../gamut/select");module.exports=function(notes){var chord=select("1 3 5 7",scale(notes,null));var t=type(chord);return t?chord[0]+t:null}},{"../chord/type":12,"../gamut/select":16,"./scale":37}],36:[function(require,module,exports){"use strict";var rotate=require("../gamut/rotate");var scale=require("../scale/scale");module.exports=function(notes){var s=scale(notes,null);return s.map(function(n,i){return rotate(i,s)})}},{"../gamut/rotate":15,"../scale/scale":37}],37:[function(require,module,exports){"use strict";var operation=require("../gamut/operation");var set=require("../set/set");var harmonics=require("../gamut/harmonics");var transpose=require("../note/transpose");var curry=require("../_curry");var split=require("../gamut/split");module.exports=curry(function(notes,tonic){notes=split(notes);var len=notes.length;if(len===0)return[];var intervals=operation(function(gamut){tonic=!tonic&&tonic!==false?gamut[0]:tonic;var s=set(gamut);var i=indexOf(gamut[0][0],s,len);var ordered=s.slice(i,len).concat(s.slice(0,i));return harmonics(ordered)},notes);tonic=!tonic&&tonic!==false?notes[0]:tonic;return intervals.map(transpose(tonic))});function indexOf(p,g,l){for(var i=0;i<l;i++){if(g[i][0]===p)return i}}},{"../_curry":11,"../gamut/harmonics":13,"../gamut/operation":14,"../gamut/split":18,"../note/transpose":29,"../set/set":39}],38:[function(require,module,exports){"use strict";var curry=require("../_curry");var transpose=require("../note/transpose");var INTERVALS=["1P","2m","2M","3m","3M","4","4#","5","6m","6M","7m","7M"];module.exports=curry(function(number,tonic){if(/^1[01]{11}$/.test(number))number=parseInt(number,2);else if(typeof number!=="number")return[];var binary=(number%2048+2048).toString(2);var set=[];for(var i=0;i<12;i++){if(binary.charAt(i)==="1"){if(i===6&&binary.charAt(5)==="1")set.push("5b");else set.push(INTERVALS[i])}}return tonic===false?set:set.map(transpose(tonic))})},{"../_curry":11,"../note/transpose":29}],39:[function(require,module,exports){"use strict";var simplify=require("../pitch/simplify");var operation=require("../gamut/operation");var sort=require("../gamut/sort");module.exports=operation(function(notes){var sorted=sort(notes.map(simplify));return sorted.reduce(function(uniq,value,index){if(index===0||!equal(sorted[index-1],value))uniq.push(value);return uniq},[])});function equal(a,b){return a[0]===b[0]&&a[1]===b[1]}},{"../gamut/operation":14,"../gamut/sort":17,"../pitch/simplify":33}]},{},[4]);